;;;
;;;	EMILY Board Console Driver
;;;

	INCLUDE	"../../emily.inc"

INIT:	DC	0
	CLA
	DCA	SMBASE+EO_HSK
	DCA	SMBASE+EO_CMD

	TAD	SIGV
	DCA	SMBASE+EO_SIG

	TAD	REQV
	DCA	SMBASE+EO_HSK

	JMP	I INIT

CONIN:	DC	0
CIN0:
	CLA
	TAD	SMBASE+EO_HSK
	TAD	REQN
	AND	MASK8
	SNA
	JMP	CIN0

	CLA
	TAD	CINC
	DCA	SMBASE+EO_CMD

	TAD	REQV
	DCA	SMBASE+EO_HSK
CIN1:
	TAD	SMBASE+EO_HSK
	TAD	REQN
	AND	MASK8
	SNA
	JMP	CIN1

	CLA
	TAD	SMBASE+EO_DAT
	AND	MASK8
	DCA	CH
	
	JMP	I CONIN

CONST:	DC	0
CST0:
	CLA
	TAD	SMBASE+EO_HSK
	TAD	REQN
	AND	MASK8
	SNA
	JMP	CST0

	CLA
	TAD	CSTC
	DCA	SMBASE+EO_CMD

	TAD	REQV
	DCA	SMBASE+EO_HSK
CST1:
	TAD	SMBASE+EO_HSK
	TAD	REQN
	AND	MASK8
	SNA
	JMP	CST1

	CLA
	TAD	SMBASE+EO_DAT
	AND	MASK8
	DCA	CH
	
	JMP	I CONST

CONOUT:	DC	0
COUT0:
	CLA
	TAD	SMBASE+EO_HSK
	TAD	REQN
	AND	MASK8
	SNA
	JMP	COUT0

	CLA
	TAD	COTC
	DCA	SMBASE+EO_CMD

	CLA
	TAD	CH
	DCA	SMBASE+EO_DAT

	TAD	REQV
	DCA	SMBASE+EO_HSK

	JMP	I CONOUT

SIGV:	DC	EG_SIG
REQV:	DC	EH_REQ
REQN:	DC	-EH_REQ
CINC:	DC	EC_CIN
CSTC:	DC	EC_CST
COTC:	DC	EC_COT
MASK8:	DC	0377
