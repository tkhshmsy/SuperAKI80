;;;
;;; 	EMILY Board Console Driver
;;;

	INCLUDE	"../../emily.inc"

INIT:
	MOVEQ	#$00,D0
	MOVE.B	D0,SMBASE+EO_HSK
	MOVE.B	D0,SMBASE+EO_CMD ; Command

	MOVE.B	#$A5,SMBASE+EO_SIG ; Signature

	MOVE.B	#$CC,SMBASE+EO_HSK ; Handshake

	RTS

CONIN:
	CMP.B	#$CC,SMBASE+EO_HSK
	BEQ	CONIN

	MOVE.B	#EC_CIN,SMBASE+EO_CMD

	MOVE.B	#$CC,SMBASE+EO_HSK
CI1:
	CMP.B	#$CC,SMBASE+EO_HSK
	BEQ	CI1

	MOVE.B	SMBASE+EO_DAT,D0

	RTS

CONST:
	CMP.B	#$CC,SMBASE+EO_HSK
	BEQ	CONST
	
	MOVE.B	#EC_CST,SMBASE+EO_CMD

	MOVE.B	#$CC,SMBASE+EO_HSK
CS1:
	CMP.B	#$CC,SMBASE+EO_HSK
	BEQ	CS1

	MOVE.B	SMBASE+EO_DAT,D0

	RTS

CONOUT:
	CMP.B	#$CC,SMBASE+EO_HSK
	BEQ	CONOUT

	MOVE.B	#EC_COT,SMBASE+EO_CMD

	MOVE.B	D0,SMBASE+EO_DAT

	MOVE.B	#$CC,SMBASE+EO_HSK

	RTS
