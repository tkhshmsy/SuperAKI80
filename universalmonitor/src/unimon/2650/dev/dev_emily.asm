;;;
;;;	EMILY Board Console Driver
;;;

	INCLUDE	"../../emily.inc"

INIT:
	LODI,R0	0
	STRA,R0	SMBASE+EO_HSK
	STRA,R0	SMBASE+EO_CMD

	LODI,R0	EG_SIG
	STRA,R0	SMBASE+EO_SIG

	LODI,R0	EH_REQ
	STRA,R0	SMBASE+EO_HSK

	RETC,UN

CONIN:
	LODA,R0	SMBASE+EO_HSK
	COMI,R0	EH_REQ
	BCTR,EQ	CONIN

	LODI,R0	EC_CIN
	STRA,R0	SMBASE+EO_CMD

	LODI,R0	EH_REQ
	STRA,R0	SMBASE+EO_HSK
CI0:
	LODA,R0	SMBASE+EO_HSK
	COMI,R0	EH_REQ
	BCTR,EQ	CI0

	LODA,R0	SMBASE+EO_DAT

	RETC,UN

CONST:
	LODA,R0	SMBASE+EO_HSK
	COMI,R0	EH_REQ
	BCTR,EQ	CONST

	LODI,R0	EC_CST
	STRA,R0	SMBASE+EO_CMD

	LODI,R0	EH_REQ
	STRA,R0	SMBASE+EO_HSK
CS0:
	LODA,R0	SMBASE+EO_HSK
	COMI,R0	EH_REQ
	BCTR,EQ	CS0

	LODA,R0	SMBASE+EO_DAT

	RETC,UN

CONOUT:
	LODA,R1	SMBASE+EO_HSK
	COMI,R1	EH_REQ
	BCTR,EQ	CONOUT

	LODI,R1	EC_COT
	STRA,R1	SMBASE+EO_CMD

	STRA,R0	SMBASE+EO_DAT

	LODI,R1	EH_REQ
	STRA,R1	SMBASE+EO_HSK

	RETC,UN
	
